(()=>{"use strict";var e={953:(e,t,n)=>{e.exports=n.p+"85a0582090fd2399f6a1.jpg"},464:(e,t,n)=>{e.exports=n.p+"e0af53aaece0e8f22074.jpg"},786:(e,t,n)=>{e.exports=n.p+"e7e3105618137b281c00.jpg"},107:(e,t,n)=>{e.exports=n.p+"be4224643449ea558df9.jpg"},750:(e,t,n)=>{e.exports=n.p+"e4cee90e4caf672b491f.jpg"},80:(e,t,n)=>{e.exports=n.p+"429b20a6dcd2d800f755.jpg"}},t={};function n(o){var r=t[o];if(void 0!==r)return r.exports;var c=t[o]={exports:{}};return e[o](c,c.exports,n),c.exports}n.m=e,n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.p="",n.b=document.baseURI||self.location.href,(()=>{var e=function(e){e.classList.toggle("popup_opened"),document.addEventListener("keydown",o)},t=function(e){e.classList.remove("popup_opened"),document.removeEventListener("keydown",o)};function o(e){if("Escape"===e.key){var n=document.querySelector(".popup_opened");t(n)}}document.querySelectorAll(".popup").forEach((function(e){e.addEventListener("mousedown",(function(e){e.target.closest(".popup__container")||t(e.target.closest(".popup"))}))}));var r=function(e,t,n){var o=e.querySelector(".photo-card__like");e.querySelector(".photo-card__like-counter").textContent=t.length,function(e,t){return Boolean(e.find((function(e){return e._id===t})))}(t,n)?o.classList.add("photo-card__like_active"):o.classList.remove("photo-card__like_active")};function c(e,t,n){!function(e){return e.some((function(e){return!e.validity.valid}))}(e)?(t.classList.remove(n.inactiveButtonClass),t.disabled=!1):(t.classList.add(n.inactiveButtonClass),t.disabled="disabled")}function a(e,t){e.classList.add(t.inactiveButtonClass),e.disabled="disabled"}function u(){document.querySelectorAll(".form__input-error").forEach((function(e){e.textContent=""})),document.querySelectorAll(".form__input").forEach((function(e){e.classList.remove("form__input_type_error")}))}new URL(n(786),n.b),new URL(n(80),n.b),new URL(n(107),n.b),new URL(n(750),n.b),new URL(n(464),n.b),new URL(n(953),n.b);var i=document.querySelector(".photo-grid__elements"),l=document.querySelector(".form_add-post"),s=document.querySelector(".popup_type_name"),d=document.querySelector(".popup_type_post"),p=document.querySelector(".popup_type_image"),f=document.querySelector(".popup_type_avatar"),m=document.querySelector(".user-profile"),_=m.querySelector(".user-profile__name-change-button"),v=m.querySelector(".user-profile__add-button"),y=s.querySelector(".popup__close-button"),h=d.querySelector(".popup__close-button"),S=document.querySelector(".popup__close-button_type_image"),b=p.querySelector(".popup__image"),q=p.querySelector(".popup__image-title"),g=document.querySelector("#form-name-change"),L=document.querySelector(".user-profile__name"),E=document.querySelector("#name-input"),k=document.querySelector(".user-profile__description"),C=document.querySelector("#profession-input"),x=d.querySelector("#place-title"),w=d.querySelector("#place-link"),A=document.querySelector(".form__button-submit-name"),j=document.querySelector(".form__button-submit-post"),U=document.querySelector(".form__button-submit-avatar"),O=document.querySelector("#form-avatar"),T=document.querySelector(".user-profile__photo"),B=document.querySelector(".user-profile__photo-button"),P=document.querySelector("#avatar-input"),R=document.querySelector(".popup__close-button_type_avatar"),D={url:"https://nomoreparties.co/v1/plus-cohort-13",headers:{authorization:"48267a8c-35ef-4976-8b19-19133ce8e68c","Content-Type":"application/json"}},I=function(e){return e.ok?e.json():Promise.reject(e)};function N(e,t){e.textContent=t?"Сохранение...":"Сохранить"}var J,H={formSelector:".form",inputSelector:".form__input",submitButtonSelector:".form__button-submit",inactiveButtonClass:"form__button-submit_inactive",inputErrorClass:"form__input_type_error",errorClass:"form__input-error_active"};function M(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}var z=function(e){L.textContent=e.name,k.textContent=e.about,T.src=e.avatar,J=e._id};Promise.all([fetch("".concat(D.url,"/cards"),{headers:D.headers}).then(I),fetch("".concat(D.url,"/users/me"),{headers:D.headers}).then(I)]).then((function(e){var t,n,o=(n=2,function(e){if(Array.isArray(e))return e}(t=e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var o,r,c=[],a=!0,u=!1;try{for(n=n.call(e);!(a=(o=n.next()).done)&&(c.push(o.value),!t||c.length!==t);a=!0);}catch(e){u=!0,r=e}finally{try{a||null==n.return||n.return()}finally{if(u)throw r}}return c}}(t,n)||function(e,t){if(e){if("string"==typeof e)return M(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?M(e,t):void 0}}(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),r=o[0],c=o[1];z(c),r.reverse().forEach((function(e){G(e,i,J,K)}))}));var $=function(e,t,n){(function(e,t){return fetch("".concat(D.url,"/cards/likes/").concat(e),{method:t?"DELETE":"PUT",headers:D.headers}).then(I)})(t,n).then((function(t){return r(e,t.likes,J)})).catch((function(e){console.log("Что-то не так! Ошибка при обновлении лайков на карточке: ".concat(e))}))},F=function(e,t){var n;(n=t,fetch("".concat(D.url,"/cards/").concat(n),{method:"DELETE",headers:D.headers}).then(I)).then((function(t){e.remove(),console.log("Внимание! ".concat(t.message))})).catch((function(e){console.log("Что-то не так! Ошибка при удалении карточки: ".concat(e))}))};_.addEventListener("click",(function(){u(),E.value=L.textContent,C.value=k.textContent,a(A,H),e(s)})),y.addEventListener("click",(function(){return t(s)})),B.addEventListener("click",(function(){u(),e(f),a(U,H)})),R.addEventListener("click",(function(){return t(f)})),v.addEventListener("click",(function(){return e(d)})),h.addEventListener("click",(function(){return t(d)})),S.addEventListener("click",(function(){return t(p)}));var G=function(e,t,n,o){var c=document.querySelector("#post-template"),a=function(e,t,n,o,c,a){var u=a.content.cloneNode(!0).querySelector(".photo-card"),i=u.querySelector(".photo-card__image"),l=u.querySelector(".photo-card__title"),s=u.querySelector(".photo-card__delete-icon"),d=u.querySelector(".photo-card__like");return i.src=e.link,l.textContent=e.name,i.alt=e.name,r(u,e.likes,t),e.owner._id!==t&&s.remove(),s.addEventListener("click",(function(){return o(u,e._id)})),d.addEventListener("click",(function(){n(u,e._id,d.classList.contains("photo-card__like_active"))})),i.addEventListener("click",(function(){return c(e)})),u}(e,n,$,F,o,c);t.prepend(a)};l.addEventListener("submit",(function(e){var n;e.preventDefault(),N(j,!0),(n={name:x.value,link:w.value},fetch("".concat(D.url,"/cards"),{method:"POST",headers:D.headers,body:JSON.stringify(n)}).then(I)).then((function(e){G(e,i,J,K),console.log("Пост добавлен! Место: ".concat(e.name,", ссылка на фото места: ").concat(e.link)),l.reset(),a(j,H),t(d)})).catch((function(e){console.log("Что-то не так! Ошибка при добавлении карточки: ".concat(e))})).finally((function(){N(j,!1)}))})),g.addEventListener("submit",(function(e){var n;e.preventDefault(),N(A,!0),(n={name:E.value,about:C.value},fetch("".concat(D.url,"/users/me"),{method:"PATCH",headers:D.headers,body:JSON.stringify(n)}).then(I)).then((function(e){z(e),console.log("Профиль успешно обновлен! Имя пользователя: ".concat(e.name,", профессия: ").concat(e.about))})).then((function(){t(s)})).catch((function(e){console.log("Что-то не так! Ошибка при изменении данных пользователя: ".concat(e))})).finally((function(){N(A,!1)}))})),O.addEventListener("submit",(function(e){var n;e.preventDefault(),N(U,!0),(n={avatar:P.value},fetch("".concat(D.url,"/users/me/avatar"),{method:"PATCH",headers:D.headers,body:JSON.stringify(n)}).then(I)).then((function(e){T.src=P.value,console.log("Аватар успешно обновлен! Ссылка на аватар: ".concat(e.avatar))})).then((function(){t(f)})).catch((function(e){console.log("Что-то не так! Ошибка при попытке изменения аватара: ".concat(e))})).finally((function(){N(U,!1)}))}));var K=function(t){b.src=t.link,q.textContent=t.name,b.alt=t.name,e(p)};!function(e){Array.from(document.querySelectorAll(e.formSelector)).forEach((function(t){t.addEventListener("submit",(function(e){e.preventDefault()})),function(e,t){var n=Array.from(e.querySelectorAll(t.inputSelector)),o=e.querySelector(t.submitButtonSelector);c(n,o,t),n.forEach((function(r){r.addEventListener("input",(function(){!function(e,t,n){t.validity.valid?function(e,t,n){var o=e.querySelector(".".concat(t.id,"-error"));t.classList.remove(n.inputErrorClass),o.classList.remove(n.errorClass),o.textContent=""}(e,t,n):function(e,t,n,o){var r=e.querySelector(".".concat(t.id,"-error"));t.classList.add(o.inputErrorClass),r.textContent=n,r.classList.add(o.errorClass)}(e,t,t.validationMessage,n)}(e,r,t),c(n,o,t)}))}))}(t,e)}))}(H)})()})();