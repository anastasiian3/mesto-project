(()=>{"use strict";var e={953:(e,t,n)=>{e.exports=n.p+"85a0582090fd2399f6a1.jpg"},464:(e,t,n)=>{e.exports=n.p+"e0af53aaece0e8f22074.jpg"},786:(e,t,n)=>{e.exports=n.p+"e7e3105618137b281c00.jpg"},107:(e,t,n)=>{e.exports=n.p+"be4224643449ea558df9.jpg"},750:(e,t,n)=>{e.exports=n.p+"e4cee90e4caf672b491f.jpg"},80:(e,t,n)=>{e.exports=n.p+"429b20a6dcd2d800f755.jpg"}},t={};function n(o){var r=t[o];if(void 0!==r)return r.exports;var c=t[o]={exports:{}};return e[o](c,c.exports,n),c.exports}n.m=e,n.d=(e,t)=>{for(var o in t)n.o(t,o)&&!n.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.p="",n.b=document.baseURI||self.location.href;var o={};(()=>{n.d(o,{x:()=>Q});var e=function(e){e.classList.toggle("popup_opened"),document.addEventListener("keydown",r)},t=function(e){e.classList.remove("popup_opened"),document.removeEventListener("keydown",r)};function r(e){if("Escape"===e.key){var n=document.querySelector(".popup_opened");t(n)}}document.querySelectorAll(".popup").forEach((function(e){e.addEventListener("mousedown",(function(e){e.target.closest(".popup__container")||t(e.target.closest(".popup"))}))})),new URL(n(786),n.b),new URL(n(80),n.b),new URL(n(107),n.b),new URL(n(750),n.b),new URL(n(464),n.b),new URL(n(953),n.b);var c=document.querySelector(".photo-grid__elements"),a=document.querySelector(".form_add-post"),u=document.querySelector("#post-template"),i=document.querySelector(".popup_type_name"),l=document.querySelector(".popup_type_post"),s=document.querySelector(".popup_type_image"),d=document.querySelector(".popup_type_avatar"),f=document.querySelector(".user-profile"),p=f.querySelector(".user-profile__name-change-button"),m=f.querySelector(".user-profile__add-button"),v=i.querySelector(".popup__close-button"),_=l.querySelector(".popup__close-button"),y=document.querySelector(".popup__close-button_type_image"),h=s.querySelector(".popup__image"),S=s.querySelector(".popup__image-title"),b=document.querySelector("#form-name-change"),q=document.querySelector(".user-profile__name"),g=document.querySelector("#name-input"),L=document.querySelector(".user-profile__description"),E=document.querySelector("#profession-input"),k=l.querySelector("#place-title"),C=l.querySelector("#place-link"),x=document.querySelector(".form__button-submit-name"),w=document.querySelector(".form__button-submit-post"),A=document.querySelector(".form__button-submit-avatar"),j=document.querySelector("#form-avatar"),O=document.querySelector(".user-profile__photo"),U=document.querySelector(".user-profile__photo-button"),P=document.querySelector("#avatar-input"),T=document.querySelector(".popup__close-button_type_avatar"),B=function(e,t,n){var o=e.querySelector(".photo-card__like");e.querySelector(".photo-card__like-counter").textContent=t.length,function(e,t){return Boolean(e.find((function(e){return e._id===t})))}(t,n)?o.classList.add("photo-card__like_active"):o.classList.remove("photo-card__like_active")};function R(e,t,n){!function(e){return e.some((function(e){return!e.validity.valid}))}(e)?(t.classList.remove(n.inactiveButtonClass),t.disabled=!1):(t.classList.add(n.inactiveButtonClass),t.disabled="disabled")}function D(e,t){e.classList.add(t.inactiveButtonClass),e.disabled="disabled"}function I(){document.querySelectorAll(".form__input-error").forEach((function(e){e.textContent=""})),document.querySelectorAll(".form__input").forEach((function(e){e.classList.remove("form__input_type_error")}))}var N,J={url:"https://nomoreparties.co/v1/plus-cohort-13",headers:{authorization:"48267a8c-35ef-4976-8b19-19133ce8e68c","Content-Type":"application/json"}},H=function(e){return e.ok?e.json():Promise.reject(e)};function M(){return fetch("".concat(J.url,"/users/me"),{headers:J.headers}).then(H)}function z(e,t){e.textContent=t?"Сохранение...":"Сохранить"}function $(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}Promise.all([fetch("".concat(J.url,"/cards"),{headers:J.headers}).then(H),M()]).then((function(e){var t,n,o=(n=2,function(e){if(Array.isArray(e))return e}(t=e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var o,r,c=[],a=!0,u=!1;try{for(n=n.call(e);!(a=(o=n.next()).done)&&(c.push(o.value),!t||c.length!==t);a=!0);}catch(e){u=!0,r=e}finally{try{a||null==n.return||n.return()}finally{if(u)throw r}}return c}}(t,n)||function(e,t){if(e){if("string"==typeof e)return $(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?$(e,t):void 0}}(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),r=o[0],a=o[1];q.textContent=a.name,L.textContent=a.about,O.src=a.avatar,N=a._id,r.reverse().forEach((function(e){K(e,c,N)}))}));var F=function(e,t,n){(function(e,t){return fetch("".concat(J.url,"/cards/likes/").concat(e),{method:t?"DELETE":"PUT",headers:J.headers}).then(H)})(t,n).then((function(t){return B(e,t.likes,N)})).catch((function(e){console.log("Что-то не так! Ошибка при обновлении лайков на карточке: ".concat(e))}))},G=function(e,t){var n;(n=t,fetch("".concat(J.url,"/cards/").concat(n),{method:"DELETE",headers:J.headers}).then(H)).then((function(t){e.remove(),console.log("Внимание! ".concat(t.message))})).catch((function(e){console.log("Что-то не так! Ошибка при удалении карточки: ".concat(e))}))};p.addEventListener("click",(function(){I(),M().then((function(t){g.value=t.name,E.value=t.about,D(x,V),e(i)})).catch((function(e){console.log("Что-то не так! Ошибка при открытии попапа редактирования данных пользователя: ".concat(e))}))})),v.addEventListener("click",(function(){return t(i)})),U.addEventListener("click",(function(){I(),M().then((function(t){P.value=t.avatar,e(d),D(A,V)})).catch((function(e){console.log("Что-то не так! Ошибка при открытии попапа изменения аватара: ".concat(e))}))})),T.addEventListener("click",(function(){return t(d)})),m.addEventListener("click",(function(){return e(l)})),_.addEventListener("click",(function(){return t(l)})),y.addEventListener("click",(function(){return t(s)}));var K=function(e,t,n){var o=function(e,t,n,o){var r=u.content.cloneNode(!0).querySelector(".photo-card"),c=r.querySelector(".photo-card__image"),a=r.querySelector(".photo-card__title"),i=r.querySelector(".photo-card__delete-icon"),l=r.querySelector(".photo-card__like");return c.src=e.link,a.textContent=e.name,c.alt=e.name,B(r,e.likes,t),e.owner._id!==t&&i.remove(),i.addEventListener("click",(function(){return o(r,e._id)})),l.addEventListener("click",(function(){n(r,e._id,l.classList.contains("photo-card__like_active"))})),c.addEventListener("click",(function(){return Q(e)})),r}(e,n,F,G);t.prepend(o)};a.addEventListener("submit",(function(e){var n;e.preventDefault(),z(w,!0),(n={name:k.value,link:C.value},fetch("".concat(J.url,"/cards"),{method:"POST",headers:J.headers,body:JSON.stringify(n)}).then(H)).then((function(e){K(e,c,N),console.log("Пост добавлен! Место: ".concat(e.name,", ссылка на фото места: ").concat(e.link)),a.reset(),D(w,V),t(l)})).catch((function(e){console.log("Что-то не так! Ошибка при добавлении карточки: ".concat(e))})).finally((function(){z(w,!1)}))})),b.addEventListener("submit",(function(e){var n;e.preventDefault(),z(x,!0),(n={name:g.value,about:E.value},fetch("".concat(J.url,"/users/me"),{method:"PATCH",headers:J.headers,body:JSON.stringify(n)}).then(H)).then((function(e){q.textContent=g.value,L.textContent=E.value,console.log("Профиль успешно обновлен! Имя пользователя: ".concat(e.name,", профессия: ").concat(e.about))})).then((function(){t(i)})).catch((function(e){console.log("Что-то не так! Ошибка при изменении данных пользователя: ".concat(e))})).finally((function(){z(x,!1)}))})),j.addEventListener("submit",(function(e){var n;e.preventDefault(),z(A,!0),(n={avatar:P.value},fetch("".concat(J.url,"/users/me/avatar"),{method:"PATCH",headers:J.headers,body:JSON.stringify(n)}).then(H)).then((function(e){O.src=P.value,console.log("Аватар успешно обновлен! Ссылка на аватар: ".concat(e.avatar))})).then((function(){t(d)})).catch((function(e){console.log("Что-то не так! Ошибка при попытке изменения аватара: ".concat(e))})).finally((function(){z(A,!1)}))}));var Q=function(t){h.src=t.link,S.textContent=t.name,h.alt=t.name,e(s)},V={formSelector:".form",inputSelector:".form__input",submitButtonSelector:".form__button-submit",inactiveButtonClass:"form__button-submit_inactive",inputErrorClass:"form__input_type_error",errorClass:"form__input-error_active"};!function(e){Array.from(document.querySelectorAll(e.formSelector)).forEach((function(t){t.addEventListener("submit",(function(e){e.preventDefault()})),function(e,t){var n=Array.from(e.querySelectorAll(t.inputSelector)),o=e.querySelector(t.submitButtonSelector);R(n,o,t),n.forEach((function(r){r.addEventListener("input",(function(){!function(e,t,n){t.validity.valid?function(e,t,n){var o=e.querySelector(".".concat(t.id,"-error"));t.classList.remove(n.inputErrorClass),o.classList.remove(n.errorClass),o.textContent=""}(e,t,n):function(e,t,n,o){var r=e.querySelector(".".concat(t.id,"-error"));t.classList.add(o.inputErrorClass),r.textContent=n,r.classList.add(o.errorClass)}(e,t,t.validationMessage,n)}(e,r,t),R(n,o,t)}))}))}(t,e)}))}(V)})()})();